(()=>{"use strict";var e={144:(e,t,r)=>{r.d(t,{Z:()=>_});var n=r(81),i=r.n(n),o=r(645),s=r.n(o),a=r(667),l=r.n(a),c=new URL(r(171),r.b),u=new URL(r(978),r.b),d=new URL(r(765),r.b),h=new URL(r(582),r.b),m=new URL(r(266),r.b),p=s()(i()),g=l()(c),f=l()(u),v=l()(d),x=l()(h),w=l()(m);p.push([e.id,'@font-face{font-family:"beon";src:url('+g+') format("opentype")}@font-face{font-family:"fixedsys";src:url('+f+') format("opentype")}*{box-sizing:border-box;-webkit-user-select:none;-ms-user-select:none;user-select:none}body,html,*{cursor:url('+v+"),auto}html{overflow:hidden}body{margin:0;height:100vh;display:flex;justify-content:center;align-items:center;font-family:beon;color:rgba(192,255,192,.9);background-color:#000;background-image:url("+x+");background-size:contain;background-position:center top;background-repeat:repeat-x}.bg-text{position:absolute;display:block;overflow-y:hidden;height:3rem;font-size:.9rem;top:-2%;left:0;right:0;z-index:-1;text-align:center;color:rgba(128,255,128,.7);font-family:fixedsys;transition:opacity .3s}@media(max-height: 620px){.bg-text{opacity:0}}.main{position:relative;height:90%;justify-content:center}.flex{display:flex;align-items:center;gap:.5rem}.column{flex-direction:column}.time__counter{min-width:4.2rem}.moves-counter{min-width:1rem}.button{min-width:34.8px;padding:5px;font-family:beon;color:lime;background-color:#020;background-repeat:no-repeat;background-position:center;border-radius:10px;border:2px solid lime;outline:none}.button:disabled{filter:brightness(0.7)}.button:not(:disabled):hover{cursor:url("+w+"),auto;box-shadow:0 0 3px 2px rgba(0,255,0,.7019607843);text-shadow:0 0 5px lime}.button:not(:disabled):active{box-shadow:inset 0 0 3px 1px rgba(0,255,0,.7019607843)}.menu__sound-button{align-self:stretch}.game{position:relative;display:flex;box-shadow:0 0 7px 4px rgba(0,255,0,.3294117647)}._{outline:2px solid blue}._>*{outline:1px dashed red}.game__winner-form{position:absolute;z-index:1;height:100%;width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1rem;text-align:center}.game__winner-input{width:13rem;height:2rem;padding-left:.5rem;font-family:fixedsys;font-size:1.15rem;outline:none;color:rgba(192,255,192,.9);background-color:#030;border:1px solid lime}.game__winner-input::placeholder{color:rgba(192,255,192,.5)}.game__winner-input:hover{cursor:url("+w+"),auto;box-shadow:0 0 3px 2px rgba(0,255,0,.7019607843);text-shadow:0 0 1px rgba(0,255,0,.4)}.blocker{position:absolute;width:100%;height:100%;z-index:0}.blocker.blocker_main{background-color:rgba(0,0,0,.5333333333)}.top__table{position:absolute;width:100%;height:100%;border-collapse:collapse;font-size:.8rem;background-color:#030;border:2px solid lime;text-align:center}.top__record{height:1.5rem;color:#fff;background-color:rgba(0,0,0,.0666666667)}.top__record-theader{border:2px solid lime}.top__record-th{background-color:rgba(0,0,0,.2);border:1px solid lime;height:1rem}.top__record-td{border:1px solid lime;overflow:hidden}",""]);const _=p},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,i,o){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(n)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);n&&s[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),r&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=r):u[2]=r),i&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=i):u[4]="".concat(i)),t.push(u))}},t}},667:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},81:e=>{e.exports=function(e){return e[1]}},379:e=>{var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var o={},s=[],a=0;a<e.length;a++){var l=e[a],c=n.base?l[0]+n.base:l[0],u=o[c]||0,d="".concat(c," ").concat(u);o[c]=u+1;var h=r(d),m={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)t[h].references++,t[h].updater(m);else{var p=i(m,n);n.byIndex=a,t.splice(a,0,{identifier:d,updater:p,references:1})}s.push(d)}return s}function i(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,i){var o=n(e=e||[],i=i||{});return function(e){e=e||[];for(var s=0;s<o.length;s++){var a=r(o[s]);t[a].references--}for(var l=n(e,i),c=0;c<o.length;c++){var u=r(o[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}o=l}}},569:e=>{var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,r)=>{e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var i=void 0!==r.layer;i&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,i&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var o=r.sourceMap;o&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},978:(e,t,r)=>{e.exports=r.p+"FSEX302.ttf"},171:(e,t,r)=>{e.exports=r.p+"beon.otf"},582:(e,t,r)=>{e.exports=r.p+"bg-pattern.png"},266:(e,t,r)=>{e.exports=r.p+"cursor.png"},765:(e,t,r)=>{e.exports=r.p+"cursor_dark.png"}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={id:n,exports:{}};return e[n](o,o.exports,r),o.exports}r.m=e,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),r.b=document.baseURI||self.location.href,r.nc=void 0,(()=>{var e=r(379),t=r.n(e),n=r(795),i=r.n(n),o=r(569),s=r.n(o),a=r(565),l=r.n(a),c=r(216),u=r.n(c),d=r(589),h=r.n(d),m=r(144),p={};p.styleTagTransform=h(),p.setAttributes=l(),p.insert=s().bind(null,"head"),p.domAPI=i(),p.insertStyleElement=u(),t()(m.Z,p),m.Z&&m.Z.locals&&m.Z.locals;const g={randomizer:(e=1,t=20)=>Math.floor(Math.random()*(t-e+1))+e,shuffle:e=>{const t=e.slice();for(let e=t.length-1;e>0;e-=1){const r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t},pause:e=>new Promise((t=>{setTimeout(t,1e3*e)})),ls:{load:e=>JSON.parse(localStorage.getItem(`erdev__${e}`)),save(e,t){localStorage.setItem(`erdev__${e}`,JSON.stringify(t))}}};class f{constructor(e,t,r,n){const i=document.createElement(t??"div");r&&(i.className=r),i.textContent=n,e.append(i),this.el=i}destroy(){this.el.remove()}}class v extends f{constructor(e,t,r){super(e,"button","button",t),this.el.onclick=r}}const{pause:x}=g;class w{constructor(e,t,r){Object.assign(this,{number:r,x:{initial:e,current:e},y:{initial:t,current:t}})}isRightPosition(){return this.x.initial===this.x.current&&this.y.initial===this.y.current}async move(e,t=.3){const r=e;this.isNextToEmptyCell(r)&&([this.x.current,r.x.current]=[r.x.current,this.x.current],[this.y.current,r.y.current]=[r.y.current,this.y.current],await x(t))}isNextToEmptyCell(e){const[t,r]=[e.x.current,e.y.current],[n,i]=[this.x.current,this.y.current];return t===n&&(r+1===i||r===i+1)||r===i&&(t+1===n||t===n+1)}}const _={muted:r.p+"sound_x.svg",none:r.p+"sound_none.svg",low:r.p+"sound_low.svg",high:r.p+"sound_high.svg",moveSound:r.p+"move.ogg"},b={TextChanged:new Event("text-changed"),SelfDestroy:new Event("self-destroy")},{pause:y}=g,z=new FontFace("beon","url('beon.otf')"),C=new f(document.body,"main","main flex column"),S=new f(C.el,"div","header flex column"),k=new class{constructor(e){this.wrapper=document.createElement("div"),this.wrapper.className="game",e.append(this.wrapper),this.canvas=document.createElement("canvas"),this.canvas.className="game__canvas",this.canvas.addEventListener("click",(e=>this.canvasClickHandler(e)));const t=Math.min(.5*window.innerHeight,.9375*window.innerWidth);this.canvas.width=t,this.canvas.height=t,this.wrapper.style.width=`${t}px`,this.wrapper.style.height=`${t}px`,this.wrapper.append(this.canvas)}#e;#t=3;#r=null;gridSize=null;matrix=null;movesCounter=0;soundVolume={current:"high",muted:{volume:0,icon:_.muted},none:{volume:1/3,icon:_.none},low:{volume:2/3,icon:_.low},high:{volume:1,icon:_.high},getIcon(){return`url(${this.getIconURL()})`},getIconURL(){return this[this.current].icon}};getCanvasSize(){const{height:e}=this.canvas,{width:t}=this.canvas;return Math.min(e,t)}setMatrix(e){if(this.matrix=Array.from(Array(this.gridSize**2),((e,t)=>new w(t%this.gridSize,Math.floor(t/this.gridSize),t+1))),e)for(let t=0;t<this.matrix.length;t+=1)this.matrix[t].x.current=e[t].x.current,this.matrix[t].y.current=e[t].y.current;this.renderField()}getEmptyCell(){return this.matrix[this.matrix.length-1]}getActiveCellList(){const e=this.getEmptyCell();return this.matrix.filter((t=>t.isNextToEmptyCell(e)))}isPuzzleCompleted(){return 0!==this.movesCounter&&!this.#r&&this.matrix.every((e=>e.isRightPosition()))}getCtx(){return this.canvas.getContext("2d")}draw(e,t,r){r?(this.strokeStyle=t,this.lineWidth=r,this.stroke(e)):(this.fillStyle=t,this.fill(e))}getCellDrawInfo(e,t){const r=this.#t,n=(this.getCanvasSize()-3*r)/this.gridSize-2*r,i=e*((this.getCanvasSize()-3*r)/this.gridSize)+2.5*r,o=t*((this.getCanvasSize()-3*r)/this.gridSize)+2.5*r;return{x0:i,y0:o,x1:i+n,y1:o+n,size:n}}renderCell(e){const t=this.#t,r=this.getCanvasSize(),n=this.getCtx();n.draw=this.draw;const i=new Path2D,[o,s]=[e.x.current,e.y.current],a=this.getCellDrawInfo(o,s);if(e===this.getEmptyCell()){const e=new Path2D;return e.rect(a.x0,a.y0,a.size,a.size),n.draw(e,"#020"),void n.draw(e,"#020",t+0)}try{i.roundRect(a.x0,a.y0,a.size,a.size,2.5*t)}catch(e){i.rect(a.x0,a.y0,a.size,a.size)}e.isRightPosition()&&(n.shadowBlur=1.5*t),n.shadowColor="#0f0",n.draw(i,e.isRightPosition()?"#003300":"#020"),n.draw(i,"#0f0",t),n.shadowBlur=0,n.font=.6*Math.min(r/this.gridSize,r/this.gridSize)+"px beon",n.textAlign="center",n.textBaseline="middle",n.lineWidth=t/2,n.strokeText(e.number,a.x0+a.size/2,a.y0+a.size/2)}async renderField(){const e=this.getCanvasSize();await z.load();const t=this.#t,r=this.getCtx();r.draw=this.draw,r.clearRect(0,0,e,e);const n=new Path2D;n.rect(t/2,t/2,e-t,e-t),r.draw(n,"#020"),r.draw(n,"#0f0",t),this.matrix&&(this.matrix.forEach((e=>this.renderCell(e))),this.saveGame("auto"),this.isPuzzleCompleted()&&this.finish())}blockerList=[];async shuffle(){M.current.clear(),await y(.3);const e=15/this.matrix.length**2,t=e=>e[g.randomizer(0,e.length-1)];let r;const n=new f(this.wrapper,"div","blocker blocker_game");this.blockerList.push(n),T.save.el.disabled=!0,T.load.el.disabled=!0,T.results.el.disabled=!0,clearInterval(this.#r),this.#r=setInterval((()=>{const n=this.getActiveCellList().filter((e=>e!==r)),i=n.filter((e=>e.isRightPosition()));r=t(i)||t(n),r.move(this.getEmptyCell(),e),this.renderField(),this.matrix.every((e=>e.x.current!==e.x.initial||e.y.current!==e.y.initial))&&(clearInterval(this.#r),this.#r=null,M.current.start(),this.blockerList.forEach((e=>e.destroy())),T.save.el.disabled=!1,T.load.el.disabled=!1,T.results.el.disabled=!1)}),1e3*e)}counterChange(e){this.movesCounter=+(e??this.movesCounter+1),P.change(this.movesCounter)}start(e){this.gridSize=e??4,this.setMatrix(),this.shuffle(),this.movesCounter=0,this.counterChange(`${this.movesCounter}`)}resume(e){const t=t=>g.ls.load(`gem-puzzle__${e}-save_${t}`);"auto"!==e||g.ls.load("gem-puzzle__auto-save_gridSize")?("manual"!==e||g.ls.load("gem-puzzle__manual-save_gridSize"))&&(this.gridSize=t("gridSize"),this.setMatrix(t("matrix")),M.current.setTime(t("time")),M.current.start(),this.movesCounter=t("moves")??0,this.counterChange(`${this.movesCounter}`),this.renderField()):this.start()}finish(){const e=M.current.getTime("short"),t=this.movesCounter,{gridSize:r}=this,n=`Hooray! You solved the puzzle in ${e} and ${t} moves!`;M.current.clear(),this.movesCounter=0,this.counterChange(`${this.movesCounter}`),this.matrix=null,this.renderField(),["erdev__gem-puzzle__manual-save_moves","erdev__gem-puzzle__manual-save_time","erdev__gem-puzzle__manual-save_gridSize","erdev__gem-puzzle__auto-save_moves","erdev__gem-puzzle__auto-save_matrix","erdev__gem-puzzle__auto-save_gridSize","erdev__gem-puzzle__auto-save_time","erdev__gem-puzzle__manual-save_matrix"].forEach((e=>localStorage.removeItem(e)));const i=new f(document.body,"div","blocker blocker_main"),o=new f(this.wrapper,"form","game__winner-form"),s=(new f(o.el,"div","game__hooray-text",n),new f(o.el,"input","game__winner-input","kekeke"));s.el.placeholder="Enter your nickname…",o.el.onsubmit=n=>((e=>{const t=g.ls.load("gem-puzzle__top-list")??[];g.ls.save("gem-puzzle__top-list",[...t,e])})({mode:r,name:s.el.value||"Wanderer",moves:t,time:e}),o.destroy(),i.destroy(),this.start(this.gridSize),!1)}zap(){const e=new Audio(_.moveSound);e.volume=this.soundVolume[this.soundVolume.current].volume,e.play()}canvasClickHandler(e){if(!this.matrix)return;const t=this.matrix.map((e=>this.getCellDrawInfo(e.x.current,e.y.current))).findIndex((t=>{return r=e.offsetX,n=e.offsetY,i=t.x0,o=t.y0,s=t.x1,a=t.y1,r>i&&r<s&&n>o&&n<a;var r,n,i,o,s,a}));t>=0&&this.matrix[t].isNextToEmptyCell(this.getEmptyCell())&&(this.matrix[t].move(this.getEmptyCell()),this.counterChange(),this.renderField(),this.zap())}saveGame(e){const t=(t,r)=>{g.ls.save(`gem-puzzle__${e}-save_${t}`,r)};t("time",M.current.getTime("raw")),t("matrix",this.matrix),t("moves",this.movesCounter),t("gridSize",this.gridSize)}}(C.el),E=new f(C.el,"div","footer flex column");new f(C.el,"div","bg-text").el.innerText="ROBCO INDUSTRIES UNIFIED OPERATING SYSTEM\nCOPYRIGHT 2075-2077 ROBCO INDUSTRIES\n-Display 1-";const T=new f(S.el,"div","menu flex"),I=new f(S.el,"div","game-info flex column"),$=new f(E.el,"div","size flex column"),M=new f(I.el,"div","time flex");M.label=new f(M.el,"div","time__label","Time:"),M.counter=new f(M.el,"div","time__counter","------------------"),M.current=new class{constructor(e){this.el=e}#n=0;#i;#o=!1;getTime(e){if("raw"===e)return this.#n;const t=e=>`${e}`.padStart(2,0),r=t(Math.floor(this.#n/60/60)%24),n=t(Math.floor(this.#n/60)%60),i=t(Math.floor(this.#n)%60);return"short"===e?`${t(60*r+ +n)}:${i}`:`${r}:${n}:${i}`}setTime(e){this.#n=e}start(){clearInterval(this.#i),this.#i=setInterval((()=>{this.setTime(this.#n+1),this.#s()}),1e3)}pause(){this.#i&&(this.#o?this.start():clearInterval(this.#i),this.#o=!this.#o)}clear(){clearInterval(this.#i),this.#i=null,this.#o=!1,this.setTime(0),this.#s()}#s(){this.el.textContent=this.getTime(),this.el.dispatchEvent(b.TextChanged)}}(M.counter.el);const P=new f(I.el,"div","moves flex");function R(){$.info.current.el.textContent=this.textContent,k.start(this.textContent[0])}P.label=new f(P.el,"div","moves__label","Moves:"),P.counter=new f(P.el,"div","moves__counter","0"),P.change=function(e){this.counter.el.textContent=e},$.info=new f($.el,"div","size__container flex"),$.info.label=new f($.info.el,"div","size__label","Frame size:"),$.info.current=new f($.info.el,"div","size__current","4x4"),$.options=new f($.el,"div","size__options flex"),T.start=new v(T.el,"restart",(function(){k.start(k.gridSize)})),T.sound=new v(T.el,"",(function(){switch(k.soundVolume.current){case"muted":k.soundVolume.current="none";break;case"none":k.soundVolume.current="low";break;case"low":k.soundVolume.current="high";break;default:k.soundVolume.current="muted"}this.style.backgroundImage=k.soundVolume.getIcon()})),T.sound.el.classList.add("menu__sound-button"),T.sound.el.style.backgroundImage=k.soundVolume.getIcon(),T.save=new v(T.el,"Save",(function(){k.saveGame("manual")})),T.load=new v(T.el,"Load",(function(){k.resume("manual")})),T.results=new v(T.el,"Top 10",(function(){M.current.pause();const e=new f(C.el,"table","top__table");e.el.addEventListener("click",(()=>{M.current.start(),e.destroy()}));const t=g.ls.load("gem-puzzle__top-list");t&&0!==t.length?(t.sort(((e,t)=>e.time.replace(":","")-t.time.replace(":",""))),e.header=new f(e.el,"tr","top__record-theader"),["name","mode","time","moves"].forEach((t=>{new f(e.header.el,"th","top__record-th",t)})),t.slice(0,10).forEach((t=>{const r=new f(e.el,"tr","top__record");new f(r.el,"td","top__record-td",t.name),new f(r.el,"td","top__record-td",`${t.mode??0}x${t.mode??0}`),new f(r.el,"td","top__record-td",t.time),new f(r.el,"td","top__record-td",t.moves)}))):e.el.click()}));for(let e=3;e<=8;e+=1)$.options[`x${e}`]=new v($.options.el,`${e}x${e}`,R);k.resume("auto"),window.addEventListener("resize",(()=>{const e=Math.min(.5*window.innerHeight,.9375*window.innerWidth);k.canvas.width=e,k.canvas.height=e,k.wrapper.style.width=`${e}px`,k.wrapper.style.height=`${e}px`,k.renderField()})),M.counter.el.addEventListener("text-changed",(()=>{k.saveGame("auto")})),console.log("-".repeat(30)),console.log("🌼Доброго времени суток!"),console.log("🌼Прошу при проверке оставить свои контакты и не скрываться за маской анонимности."),console.log('🌼Переключение звука имеет 4 режима. Иконка выключенного звука имеет вид "Динамик с крестиком"'),console.log("🌼Сохранение и загрузка игры при ручном и автоматическом сейве происходят независимо друг от друга."),console.log("🌼Спасибо за внимание! :)"),console.log("-".repeat(30))})()})();